#!/bin/bash
# -----------------------------------------------------------------------------
menu_menu()
{

  while true; do
    __menu \
    -t 'CLICKPANIC' \
    -o '*>> Manage Installation' \
    -o '*>> Manage system' \
    -o '*>> Manage network' \
    -o '*>> Manage multimedia' \
    -o '*>> Manage Web server' \
    -o '> Manage backups' \
    -o '> Manage Text File' \
    -o '> Manage mail server' \
    -o '> Manage ERP softwares' \
    -o '*>> Manage Hardware' \
    -o 'Logs' \
    -o 'Debug' \
    -o 'Website'
    
    case $REPLY in
      1) install_menu;;
      2) system_menu;;
      3) network_menu;;
      4) multimedia_menu;;
      5) web_menu;;
      6) . "${file_prefix}"backup.sh -m;;
      7) . "${file_prefix}"textfile.sh -m;;
      8) . "${file_prefix}"mail.sh -m;;
      9) . "${file_prefix}"openerp.sh -m;;
      10) hardware_menu;;
      11) . "${file_prefix}"log.sh -m;;
      12) . "${file_prefix}"debug.sh -m;;
      13) source "${file_prefix}"website.sh; website_menu;;
    esac
  done
}
# ------------------------------------------------------------------------------
install_menu ()
{
  while true; do
    __menu \
    -t 'Installation' \
    -o '> Install system' \
    -o '> Install drivers' \
    -o '> Install PS3'
    
    case $REPLY in
      1) . "${file_prefix}"base.sh -m;;
      2) . "${file_prefix}"driver.sh -m;;
      3) . "${file_prefix}"ps3.sh -m;;
    esac
  done
}
# ------------------------------------------------------------------------------
system_menu ()
{
  while true; do
    __menu \
    -t 'System' \
    -o '> Manage APT' \
    -o '> Manage Debconf packages' \
    -o '> Manage DVB' \
    -o '> Manage Hardware' \
    -o '> Manage Disks' \
    -o '> Manage Users and groups' \
    -o '> Kill service' \
    -o '> List service'
    
    case $REPLY in
      1) . "${file_prefix}"deb.sh -m;;
      2) . "${file_prefix}"debconf.sh -m;;
      3) . "${file_prefix}"dvb.sh -m;;
      4) . "${file_prefix}"hardware.sh -m;;
      5) . "${file_prefix}"disk.sh -m;;
      6) . "${file_prefix}"user.sh -m;;
      7) kill_service;;
      8) list_service;;
    esac
  done
}
# ------------------------------------------------------------------------------
multimedia_menu ()
{
  while true; do
    __menu \
    -t 'Multimedia' \
    -o '> Manage Media Center' \
    -o '> Manage Multimedia'
    
    case $REPLY in
      1) menu_mediacenter;;
      2) . "${file_prefix}"player.sh -m;;
    esac
  done
}
# ------------------------------------------------------------------------------
network_menu ()
{
  while true; do
    __menu \
    -t 'Network' \
    -o '> Manage Lan' \
    -o '> Manage Samba share' \
    -o '> Manage SSH host' \
    -o '> Manage LDAP host' \
    -o '> Manage FTP server' \
    -o '> Manage VPN' \
    -o '> Manage OpenLDAP'
    
    case $REPLY in
      1) . "${file_prefix}"lan.sh -m;;
      2) . "${file_prefix}user.sh"
      . "${file_prefix}"samba.sh -m;;
      3) . "${file_prefix}"ssh.sh -m;;
      4) . "${file_prefix}"ldap.sh -m;;
      5) . "${file_prefix}"ftp.sh -m;;
      6) . "${file_prefix}"vpn.sh -m;;
      7) . "${file_prefix}"openldap.sh -m;;
    esac
  done
  
}
# ------------------------------------------------------------------------------
web_menu ()
{
  while true; do
    __menu \
    -t 'Web Server' \
    -o '> Manage Apache Web project' \
    -o '> Manage MySQL Database' \
    -o '> Manage PHP'
    
    case $REPLY in
      1) . "${file_prefix}lan.sh"; . "${file_prefix}"apache.sh -m;;
      2) . "${file_prefix}"mysql.sh -m;;
      3) . "${file_prefix}"php.sh -m;;
    esac
  done
}
# ------------------------------------------------------------------------------
hardware_menu ()
{
  while true; do
    __menu \
    -t 'Hardware' \
    -o 'Hardware' \
    -o 'Driver'
    
    case $REPLY in
      1) . "${file_prefix}"hardware.sh;;
        2) . "${file_prefix}"driver.sh -m;;
    esac
  done
}
# ------------------------------------------------------------------------------
mediacenter_menu ()
{
  while true; do
    __menu \
    -t 'Media Center' \
    -o '> Manage FreePlayer'
    -o '> Manage Mediatomb media (transcoder) server' \
    -o '> Manage uShare media server'
    
    case $REPLY in
      1) . "${file_prefix}"freeplayer.sh -m;;
      2) . "${file_prefix}"mediatomb.sh -m;;
      3) . "${file_prefix}"ushare.sh -m;;
    esac
  done
}

# ------------------------------------------------------------------------------
backup_menu ()
{
  while true; do
    __menu \
    -t 'Backup' \
    -o 'List installed .DEB' \
    -o 'Backup file list' \
    -o 'Backup all Web Projects' \
    -o 'Uninstall a Soft and all associated debs' \
    -o 'Restore DEBs' \
    -o 'Restore file list' \
    -o 'Restore original config files' \
    -o 'Restore a Web project' \
    -o 'Restore a Web project Database' \
    -o 'Purge old backups' \
    -o 'Backup distinct file list'
    
    case $REPLY in
      1) list_deb;;
      2) backup_filelist;;
      3);;
      4) hard_uninstall;;
      5) restore_deb;;
      6);;
      7);;
      8);;
      9);;
      10) purge_backup;;
      11) backup_distinct_filelist;;
    esac
  done
}

# ------------------------------------------------------------------------------

script_short_description='management functions'; file_prefix=$(dirname "$0")'/clickpanic_'; [[ ! "$(declare -Ff 'menu')" ]] && source "${file_prefix}helpers.sh"
